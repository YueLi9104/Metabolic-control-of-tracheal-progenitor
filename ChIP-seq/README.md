# Metabolic control of progenitor cell propagation during _Drosophila_ tracheal remodeling

## ChIP-seq analysis scripts

### Fig. 6 & Fig. S6

This is the repository for scripts that were used in paper:

*Metabolic control of progenitor cell propagation during *Drosophila* tracheal remodeling*

_Li and Dong et al, 2021_

## ChIP-seq_QC

Quality control and peak annoation for our ChIP-seq data via R package ChIPseeker.

1. Read peak files(.bed file).
2. Get genome annotation and generate TSS regions for peaks mapping.
3. Associate peaks to TSS regions and annotate peaks.
4. Save peak annotation and export stat information.
5. Visualize the spatial distribution of peaks in genome.
6. Contrast between two parallel ChIP-seq experiments.

### Input

A .bed file generated by MACS2 after peak calling is required.

```
sp1.bed
```

### Usage

run via R-studio and R:

```
ChIP-seq_QC.Rmd
```

### Output

All plots have been embedded in `ChIP-seq_QC.Rmd` file and can be exported by `save as ...` or `export`.
A reference pipeline(`ChIP-seq_QC.nb.html`) is provided with embedded output.

## HOMER

HOMER (Hypergeometric Optimization of Motif EnRichment) is a suite of tools for Motif Discovery and next generation sequencing analysis. It is a collection of command line programs for **UNIX-style** operating systems written in Perl and C++. HOMER is written as a de novo motif discovery algorithm and is well suited for identifying 8-20 bp motifs in large scale genomics data.

### Input

A .bed file generated by MACS2 after peak calling is required.
**example**

```
sp1.bed
```

### Usage: Bash command

```
# After adding findMotifsGenome.pl to $PATH
$ findMotifsGenome.pl <peak/BED file> <genome> <output directory> -size # [options]
```

**example**

```
$ findMotifsGenome.pl sp1.bed dm6 sp1 -mask -p 4 -bits
```

### Output

A folder with motif information(.html files).
Then we can extract Position Weight Matrix(pwm) from these html files and visualize motifs.

## Motif visualization

use the motif matrices extracted from Homer results(.txt files) to visualize motifs.

### Input

Position weight matrices(pwms) from HOMER result are required.

```
.
├─motif_file
│      aef1.txt
│      kr.txt
│      sd.txt
│      trl.txt
```

### Usage

run via R-studio and R:

```
Motif_visualization.Rmd
```

### Output

All plots are embedded in `Motif_visualization.Rmd` file and can be exported by `save as ...` or `export`.
A reference pipeline(`Motif_visualization.nb.html`) is also provided with embedded output.

## pygenometracks

pyGenomeTracks aims to produce high-quality genome browser tracks that are highly customizable.

### Input

A .bw file generated by mapping reads to _Drosophila_ genome.

```
sample1.bw
```

### Usage

To run pyGenomeTracks, a configuration file describing the tracks is required.
make_tracks_file which creates a configuration file with defaults that are changable.
The format is:

```
$ make_tracks_file --trackFiles <file1.bed> <file2.bw> ... -o tracks.ini
```

make_tracks_file uses the file ending to predict the file type.

Then, a region can be plotted using:

```
$ pyGenomeTracks --tracks tracks.ini --region chr2:10,000,000-11,000,000 --outFileName nice_image.pdf
```

The ending --outFileName defines the format of image. If .pdf is used, then the output image is a pdf. The options are pdf, png and svg.
**example**

```
# After installed pygenometracks via conda
$ conda activate pygenometracks
# make_tracks_file --trackFiles <bigwig file> <bed file> etc. -o tracks.ini
$ make_tracks_file --trackFiles sample1.bw -o tracks.ini
$ pyGenomeTracks --tracks tracks.ini --region chr2L:17645053-17780340 -o cadN.png --dpi 256
```

### Parameters

These genomic regions below are obtained via `dm6` genomic annoataion.

```
cadN：chr2L:17645053-17780340
pebbled：chrX:4615564-4629206
Dally：chr3L:8825505-8893192
dlp：chr3L:14630601-14673609
Ex：chr2L:429227-450701
Diap1：chr3L:16033546-16059898
```

### Output

.png files with peaks and related genomic regions.


## File tree

```
.
│  ChIP-seq_QC.nb.html
│  ChIP-seq_QC.Rmd
│  homer.html
│  homer.md
│  Motif_visualization.html
│  Motif_visualization.Rmd
│  pygenometracks.html
│  pygenometracks.md
│  README.html
│  README.md
│  sample1.bw
│  sp1.bed
│  sp2.bed
│
├─motif_file
│      aef1.txt
│      kr.txt
│      sd.txt
│      trl.txt
│
└─peak_annotations
        all.csv
        all_promoters.csv
        stat_sp1.csv
```

## Citations

> R Core Team (2019). R: A language and environment for statistical computing. R
> Foundation for Statistical Computing, Vienna, Austria. URL
> https://www.R-project.org/.

> Guangchuang Yu, Li-Gen Wang, and Qing-Yu He. ChIPseeker: an R/Bioconductor package
> for ChIP peak annotation, comparison and visualization. Bioinformatics 2015,
> 31(14):2382-2383

> Marc Carlson (2019). org.Dm.eg.db: Genome wide annotation for Fly. R package version
> 3.10.0.

> Heinz S, Benner C, Spann N, Bertolino E et al. Simple Combinations of Lineage-Determining Transcription Factors Prime cis-Regulatory Elements Required for Macrophage and B Cell Identities. Mol Cell 2010 May 28;38(4):576-589. PMID: 20513432

> Oliver Bembom (2019). seqLogo: Sequence logos for DNA sequence alignments. R package
> version 1.52.0.

> Lopez-Delisle L, Rabbani L, Wolff J, Bhardwaj V, Backofen R, Grüning B, Ramírez F, Manke T. pyGenomeTracks: reproducible plots for multivariate genomic data sets. Bioinformatics. 2020 Aug 3:btaa692. doi: 10.1093/bioinformatics/btaa692. Epub ahead of print. PMID: 32745185.
